version: '3.8'

# Local dev: builds from source. Run from repo root: docker-compose -f tools/docker-compose.yml up
# For pre-built image from Docker Hub, use: docker-compose -f tools/docker-compose.prod.yml up
# Dev uses a named volume so repo stays clean and personal data isn't accidentally committed.
services:
  rotorhazard:
    build:
      context: ..
      dockerfile: Dockerfile
    container_name: rotorhazard-server
    ports:
      - "5000:5000"
    volumes:
      - rotorhazard-dev-data:/app/data
    environment:
      - RH_DATA_DIR=/app/data
    restart: unless-stopped
    # Hardware access (USB, GPIO, SPI, I2C)
    # Privileged mode gives full access to all devices (recommended for Pi)
    privileged: true

volumes:
  rotorhazard-dev-data: